function a(a){const e=a.toString();let t=2166136261;for(let a=0;a<e.length;a++)t^=e.charCodeAt(a),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}function e(a,e){return new Promise((t=>setTimeout((()=>{"function"==typeof e?t(e()):t()}),a)))}function t(e,t=a=>a){return new class{constructor(a){this.name=a,window.aloneFrameLoaderCacheDataList=window.aloneFrameLoaderCacheDataList||{},!window.aloneFrameLoaderCacheDataList[this.name]&&this.del()}get(a){const e={...{...window.aloneFrameLoaderCacheDataList[this.name]||{}}.blob||{}};return a?e[a]||a:e}set(e,t){const s=typeof e;return"object"===s?Array.isArray(e)?e.forEach((a=>this.set(a))):Object.entries(e).forEach((([a,e])=>this.set(a,e))):"function"===s?this.set((e.name||"callback")+"-"+a(e),e):"string"!==s&&"number"!==s||window.aloneFrameLoaderCacheDataList[this.name].list.push({alias:e,value:void 0!==t?t:e}),this}del(){return window.aloneFrameLoaderCacheDataList[this.name]={list:[],blob:{}},this}async load(a=(a,e)=>null,e=1,s=0){a="function"==typeof a?a:()=>null;const{list:o=[]}=window.aloneFrameLoaderCacheDataList[this.name]||{},n=o.reduceRight(((a,e)=>(!a.some((a=>a.alias===e.alias))&&a.unshift(e),a)),[]),i=n.length;if(i>0){const o=Array(i).fill(0),r=(e,t)=>{const s=o.reduce(((a,e)=>a+e),0)/i,n=Math.min(100,100*s).toFixed(2);a(n,{type:e,...t})},l=async(a,e)=>{s>0&&await new Promise((a=>setTimeout(a,s)));try{if("string"==typeof a.value){window.aloneFrameLoaderCacheDataList[this.name].blob[a.alias]=a.value;const s=await(n=a.value,i=t=>{t.lengthComputable&&(o[e]=t.loaded/t.total,r("progress",{alias:a.alias,data:t}))},new Promise((a=>{const e=new XMLHttpRequest;e.timeout=2e4,e.responseType="blob",e.open("GET",n,!0),e.onerror=()=>a({code:e.status,msg:`Network Error (${e.statusText})`}),e.ontimeout=()=>a({code:e.status,msg:`Request Timeout (${e.statusText})`}),"function"==typeof i&&(e.onprogress=a=>i(a)),e.onloadend=()=>200===e.status?a({code:200,msg:"success",body:e.response}):a({code:e.status,msg:`Unknown Error (${e.statusText})`}),(("function"==typeof t?t:a=>a)(e)||e).send()})));if(200===s.code){const e=URL.createObjectURL(s.body);window.aloneFrameLoaderCacheDataList[this.name].blob[a.alias]=e,r("loading",{alias:a.alias,data:e})}else r("error",{alias:a.alias,data:s.msg})}else if("function"==typeof a.value){const e=await a.value();window.aloneFrameLoaderCacheDataList[this.name].blob[a.alias]=e,r("loading",{alias:a.alias,data:e})}o[e]=1}catch(t){r("error",{alias:a.alias,data:t.message}),o[e]=1}var n,i},c=[];for(let a=0;a<i;a+=e)c.push(n.slice(a,a+e));for(const[a,t]of c.entries())await Promise.all(t.map(((t,s)=>l(t,a*e+s))))}return a(100,{type:"success",data:this.get()}),this}}(e)}export{t as aloneLoader,t as default,a as getFunHash,e as waitSleep};
